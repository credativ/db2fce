SET search_path = db2,pg_catalog,public;
-- MICROSECOND()
SELECT MICROSECOND('0001-01-01 00:00:00.100000') FROM SYSIBM.SYSDUMMY1;
 microsecond 
-------------
      100000
(1 row)

SELECT MICROSECOND('0001-01-01 12:35:30.100001') FROM SYSIBM.SYSDUMMY1;
 microsecond 
-------------
      100001
(1 row)

SELECT MICROSECOND('0001-01-01 12:35:30.500001') FROM SYSIBM.SYSDUMMY1;
 microsecond 
-------------
      500001
(1 row)

-- SECOND()
SELECT SECOND('0001-01-01 12:35:30.100001') FROM SYSIBM.SYSDUMMY1;
 second 
--------
     30
(1 row)

SELECT SECOND('0001-01-01 12:35:30.500001') FROM SYSIBM.SYSDUMMY1;
 second 
--------
     30
(1 row)

-- MINUTE()
SELECT MINUTE('0001-01-01 12:35:30.100001') FROM SYSIBM.SYSDUMMY1;
 minute 
--------
     35
(1 row)

SELECT MINUTE('0001-01-01 12:35:30.100001+02:00') FROM SYSIBM.SYSDUMMY1;
 minute 
--------
     35
(1 row)

-- HOUR()
SELECT HOUR('0001-01-01 12:35:30.100001') FROM SYSIBM.SYSDUMMY1;
 hour 
------
   12
(1 row)

SELECT HOUR('0001-01-01 12:35:30.100001+02:00') FROM SYSIBM.SYSDUMMY1; -- WRONG
 hour 
------
   12
(1 row)

-- DAY()
SELECT DAY('0001-01-01 12:35:30.100001') FROM SYSIBM.SYSDUMMY1;
 day 
-----
   1
(1 row)

SELECT DAY('1000-01-01') FROM SYSIBM.SYSDUMMY1;
 day 
-----
   1
(1 row)

SELECT DAY('0004-02-29') FROM SYSIBM.SYSDUMMY1;
 day 
-----
  29
(1 row)

-- YEAR()
SELECT YEAR('0001-01-01') FROM SYSIBM.SYSDUMMY1;
 year 
------
    1
(1 row)

SELECT YEAR(CURRENT_TIMESTAMP) FROM SYSIBM.SYSDUMMY1;
 year 
------
 2019
(1 row)

-- DAYS()
SELECT DAYS('1000-01-01') FROM SYSIBM.SYSDUMMY1;
  days  
--------
 364878
(1 row)

SELECT DAYS('0000-01-01') FROM SYSIBM.SYSDUMMY1; -- ERROR
 days 
------
 -365
(1 row)

SELECT DAYS('0001-01-01') FROM SYSIBM.SYSDUMMY1;
 days 
------
    1
(1 row)

-- MONTHS_BETWEEN()
SELECT MONTHS_BETWEEN('0002-01-01', '0001-01-01') FROM SYSIBM.SYSDUMMY1;
   months_between   
--------------------
 12.000000000000000
(1 row)

SELECT MONTHS_BETWEEN('0002-01-01', '0001-01-02') FROM SYSIBM.SYSDUMMY1;
   months_between   
--------------------
 11.967741935483900
(1 row)

SELECT MONTHS_BETWEEN('0002-01-01', '0001-01-03') FROM SYSIBM.SYSDUMMY1;
   months_between   
--------------------
 11.935483870967700
(1 row)

SELECT MONTHS_BETWEEN('0003-01-01', '0001-01-02') FROM SYSIBM.SYSDUMMY1;
   months_between   
--------------------
 23.967741935483900
(1 row)

SELECT MONTHS_BETWEEN('2008-01-17', '2008-02-17') FROM SYSIBM.SYSDUMMY1;
   months_between   
--------------------
 -1.000000000000000
(1 row)

SELECT MONTHS_BETWEEN('2008-02-17', '2008-03-17') FROM SYSIBM.SYSDUMMY1;
   months_between   
--------------------
 -1.000000000000000
(1 row)

SELECT MONTHS_BETWEEN('2008-02-20', '2008-01-17') FROM SYSIBM.SYSDUMMY1;
  months_between   
-------------------
 1.096774193548390
(1 row)

SELECT MONTHS_BETWEEN('2008-01-17', '2008-02-20') FROM SYSIBM.SYSDUMMY1;
   months_between   
--------------------
 -1.096774193548390
(1 row)

SELECT MONTHS_BETWEEN('2008-02-20', '2008-01-20') FROM SYSIBM.SYSDUMMY1;
  months_between   
-------------------
 1.000000000000000
(1 row)

SELECT MONTHS_BETWEEN('2014-07-09', '2014-06-10') FROM SYSIBM.SYSDUMMY1;
  months_between   
-------------------
 0.967741935483871
(1 row)

SELECT MONTHS_BETWEEN('2014-07-09 14:00:00.000000', '2014-06-10') FROM SYSIBM.SYSDUMMY1;
  months_between   
-------------------
 0.986559139784946
(1 row)

SELECT MONTHS_BETWEEN('2014-07-09 14:30:00.000000', '2014-06-10') FROM SYSIBM.SYSDUMMY1;
  months_between   
-------------------
 0.987231182795699
(1 row)

SELECT MONTHS_BETWEEN('2014-07-09 14:30:30.000000', '2014-06-10') FROM SYSIBM.SYSDUMMY1;
  months_between   
-------------------
 0.987242383512545
(1 row)

SELECT MONTHS_BETWEEN('2014-07-09 14:30:30.000000+06:00', '2014-06-10') FROM SYSIBM.SYSDUMMY1;
  months_between   
-------------------
 0.969769265232975
(1 row)

SELECT ROUND(MONTHS_BETWEEN('2008-03-29', '2008-02-29')*31,2) FROM SYSIBM.SYSDUMMY1;
 round 
-------
 31.00
(1 row)

SELECT ROUND(MONTHS_BETWEEN('2008-03-30', '2008-02-29')*31,2) FROM SYSIBM.SYSDUMMY1;
 round 
-------
 32.00
(1 row)

SELECT ROUND(MONTHS_BETWEEN('2008-03-31', '2008-02-29')*31,2) FROM SYSIBM.SYSDUMMY1; -- WRONG ("The result 
 round 
-------
 33.00
(1 row)

-- is not 33 because both dates are the last day of their respective month, and so the result is only based 
-- on the year and month portions.")
-- TIMESTAMP_FORMAT()
SELECT timestamp_format('2017-04-16 23:59:59.123456789012', 'YYYY-MM-DD HH24:MI:SS.FF12');
        timestamp_format         
---------------------------------
 Sun Apr 16 23:59:59.123456 2017
(1 row)

SELECT timestamp_format('2017-04-16 23:59:59.123456789', 'YYYY-MM-DD HH24:MI:SS.FF9');
        timestamp_format         
---------------------------------
 Sun Apr 16 23:59:59.123456 2017
(1 row)

SELECT timestamp_format('2017-04-16 23:59:59.123456', 'YYYY-MM-DD HH24:MI:SS.FF');
        timestamp_format         
---------------------------------
 Sun Apr 16 23:59:59.123456 2017
(1 row)

SELECT timestamp_format('2017-04-16 23:59:59.1234', 'YYYY-MM-DD HH24:MI:SS.FF');
       timestamp_format        
-------------------------------
 Sun Apr 16 23:59:59.1234 2017
(1 row)

SELECT timestamp_format('2017-04-16 23:59:59.12', 'YYYY-MM-DD HH24:MI:SS.FF');
      timestamp_format       
-----------------------------
 Sun Apr 16 23:59:59.12 2017
(1 row)

SELECT timestamp_format('2017-04-16 23:59:59.12', 'YYYY-MM-DD HH24:MI:SS');
     timestamp_format     
--------------------------
 Sun Apr 16 23:59:59 2017
(1 row)

SELECT timestamp_format('2017-04-16 23:59:59', 'YYYY-MM-DD HH24:MI:SS');
     timestamp_format     
--------------------------
 Sun Apr 16 23:59:59 2017
(1 row)

SELECT timestamp_format('2017-May-16 23:59:59', 'YYYY-Mon-DD HH24:MI:SS');
     timestamp_format     
--------------------------
 Tue May 16 23:59:59 2017
(1 row)

SELECT timestamp_format('2017-02-29 13:00:00', 'YYYY-MM-DD HH24:MI:SS');
ERROR:  date/time field value out of range: "2017-02-29 13:00:00"
CONTEXT:  SQL function "timestamp_format" statement 1
